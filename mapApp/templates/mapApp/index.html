<!DOCTYPE html>
<html>
    <head>
        <!-- Loads bootstrap, js, css, and metadata tags -->
        {% include 'mapApp/header.html' %}
        {% load staticfiles %}
        <!-- Load leaflet -->
        <link rel="stylesheet" href="{% static 'leaflet/leaflet.css' %}"/>

        <!-- Load the leaflet map and functions -->
        <script src="{% static 'leaflet/leaflet.js' %}"></script>
        <script src="{% static 'mapApp/js/map.js' %}"></script>
    
    </head>


    <body>
        <!-- Tag to include nav_bar.html code with index template -->
        {% include 'mapApp/nav_bar.html' %}
       
        <!-- Modal form popup -->
        {% include 'mapApp/incident_form.html' %}
        
        <!-- Leaflet map --> 
        <div id="map"></div>

        <!-- Scripts controlling rendering of map -->
        <script>
            // Create the map
            initialize();

            // Enable click to add point
            map.on('click', addNewPoint);
            

        </script>


        {% for incident in incidents %}
            <script>
                var latlng = [ {{ incident.point.coords.1 }}, {{ incident.point.coords.0 }} ];
                var msg = "<b>{{ incident.incident_type }}</b><br>{{ incident.incident_date }}.";
                addPoint( latlng, msg );
            </script>
        {% endfor %}



        


        <div id="panel">
            <button onclick="toggleUserData(); toggleICBC()" class="btn btn-primary pull-left btn-block">Toggle</button>
            <button onclick="toggleUserData()" class="btn btn-success pull-left btn-block">Citizen Data</button>
            <!-- The next commented out line is a button to toggle a heatmap -->
            <!-- <button onclick="toggleHeatmap()" class="btn btn-success pull-left btn-block">Toggle User Data Heatmap</button> -->
            <button onclick="toggleICBC()" class="btn btn-success pull-left btn-block">ICBC Data</button>

            <button onclick="toggleICBCHM()" class="btn btn-danger pull-left btn-block">Toggle ICBC heatmap</button>
            <button onclick="toggleBikeRacks()" class="btn btn-success pull-left btn-block">Bike Racks</button>
            <!-- <button id="KMLlayers1" onclick="toggleLayer(1)" class="btn btn-success pull-right">Bike Racks</button> -->

        </div>



   
    </body>
</html>